---
layout: post
title: Recommending wines and segmenting wine drinkers
---
Data: Wine sales data  
Techniques: k-means clustering, matrix factorization

Looking at the most popular wines, k-means clustering to segment wine drinkers by the kinds of wine they buy, and recommending wines.

[Part I- Clustering Wine Drinkers](https://github.com/JoomiK/WineDrinkers/blob/master/winedrinkers/WineDrinkers.ipynb) 
 
[Part II- Recommending Wines](https://github.com/JoomiK/WineDrinkers/blob/master/winedrinkers/WineDrinkers2.ipynb) 

---


## Wine drinkers

#### Part 1- Segmenting wine drinkers
Here I explore online sales data for a wine store based in the Upper East Side in NYC. Although online sales are not representative of total sales for this particular store (most of their sales are in-store), it will be informative to take a look at what online customers are buying.

In Part 2 I'll use this data to build wine recommenders.


```python
%matplotlib inline

import pandas as pd
import numpy as np
from sklearn.cluster import KMeans
from sklearn.decomposition import PCA
from sklearn import metrics
from ggplot import *
import matplotlib.pyplot as plt
import seaborn as sns
```


```python
data = pd.read_csv('wine_data.csv')
```

#### We have data for purchases by wine type. Each row is a customer.


```python
data.head()
```


<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cabernet Sauvignon</th>
      <th>Pinot Noir</th>
      <th>Zinfandel</th>
      <th>Syrah</th>
      <th>Cabernet Franc</th>
      <th>Malbec</th>
      <th>Barbera</th>
      <th>Sangiovese</th>
      <th>Montepulciano</th>
      <th>Merlot</th>
      <th>...</th>
      <th>Espumante</th>
      <th>Champagne</th>
      <th>Port</th>
      <th>Chardonnay</th>
      <th>Sauvignon Blanc</th>
      <th>Pinot Grigio</th>
      <th>Riesling</th>
      <th>Gewurztraminer</th>
      <th>Semillon</th>
      <th>Muscat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>




```python
data.describe()
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cabernet Sauvignon</th>
      <th>Pinot Noir</th>
      <th>Zinfandel</th>
      <th>Syrah</th>
      <th>Cabernet Franc</th>
      <th>Malbec</th>
      <th>Barbera</th>
      <th>Sangiovese</th>
      <th>Montepulciano</th>
      <th>Merlot</th>
      <th>...</th>
      <th>Espumante</th>
      <th>Champagne</th>
      <th>Port</th>
      <th>Chardonnay</th>
      <th>Sauvignon Blanc</th>
      <th>Pinot Grigio</th>
      <th>Riesling</th>
      <th>Gewurztraminer</th>
      <th>Semillon</th>
      <th>Muscat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>...</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
      <td>288.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.791667</td>
      <td>1.506944</td>
      <td>1.406250</td>
      <td>0.611111</td>
      <td>0.885417</td>
      <td>0.180556</td>
      <td>0.402778</td>
      <td>0.364583</td>
      <td>0.402778</td>
      <td>0.968750</td>
      <td>...</td>
      <td>0.069444</td>
      <td>0.069444</td>
      <td>0.083333</td>
      <td>1.385417</td>
      <td>0.961806</td>
      <td>0.402778</td>
      <td>0.388889</td>
      <td>0.388889</td>
      <td>0.322917</td>
      <td>0.336806</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.167952</td>
      <td>1.361474</td>
      <td>1.355681</td>
      <td>1.040042</td>
      <td>0.920572</td>
      <td>0.474474</td>
      <td>0.628248</td>
      <td>0.609789</td>
      <td>0.660687</td>
      <td>1.047178</td>
      <td>...</td>
      <td>0.267985</td>
      <td>0.366788</td>
      <td>0.344190</td>
      <td>1.343741</td>
      <td>1.216295</td>
      <td>0.665940</td>
      <td>0.636969</td>
      <td>0.625933</td>
      <td>0.544112</td>
      <td>0.579348</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>2.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.000000</td>
      <td>5.000000</td>
      <td>5.000000</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>2.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>4.000000</td>
      <td>6.000000</td>
      <td>...</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>3.000000</td>
      <td>5.000000</td>
      <td>3.000000</td>
      <td>4.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
      <td>3.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 22 columns</p>
</div>



### The most popular wines


```python
data.mean().plot(kind='bar')
```




    <matplotlib.axes._subplots.AxesSubplot at 0x111c2cf28>




![png](/images/output_8_1.png)


The most popular wines are Pinot Noir, Zinfandel, Merlot, Chardonnay, and Sauvignon Blanc.

### Clustering.


```python
X = data[data.columns]

# All column names (wine types) are stored as x_cols
x_cols = data.columns
```

I'll use the elbow method to find the optimal number of clusters. This identifies the value of k (number of clusters) where the distortion (the within-cluster sum of squared errors or SSE) begins to increase the most rapidly.


```python
distortions = []
for i in range (1,10):
    km = KMeans(n_clusters=i,
               init='k-means++',
               n_init=10,
               max_iter=300,
               random_state=0)
    km.fit(X)
    distortions.append(km.inertia_)
    
plt.plot(range(1,10), distortions, marker='o')
plt.xlabel('Number of clusters')
plt.ylabel('Distortion')
plt.show()
```


![png](/images/output_13_0.png)


It looks like the elbow is located at k=3... We can also use the silhouette score; this is a measure of how similar an objects is to its own cluster compared to other clusters. The score is higher when clusters are dense and well separated. A score of 1 is the highest and a score of -1 is the lowest. Scores around zero indicate overlapping clusters.


```python
silhouette = {}
for i in range (2,10):
    km = KMeans(n_clusters=i,
               init='k-means++',
               n_init=10,
               max_iter=300,
               tol=1e-04,
               random_state=0)
    km.fit(X)
    silhouette[i] = metrics.silhouette_score(X, km.labels_, metric='euclidean')

silhouette
```




    {2: 0.31931332744051177,
     3: 0.36448555932200755,
     4: 0.31707194676835887,
     5: 0.32698272012743929,
     6: 0.31207073251298323,
     7: 0.26206479403635502,
     8: 0.26891906112067659,
     9: 0.24363780237120475}



k=3 gives the highest score, by a hair. In general these scores are not that high indicating that there will be a fair amount of overlap between clusters. 


```python
cluster3 = KMeans(n_clusters=3,
               init='k-means++',
               n_init=10,
               max_iter=300,
               tol=1e-04,
               random_state=0)
```


```python
# Add a column that indicates which cluster each point falls into
data['cluster3'] = cluster3.fit_predict(X)

# Let's see how many are in each cluster
data.cluster3.value_counts()
```




    0    155
    1     77
    2     56
    Name: cluster3, dtype: int64



#### To visualize the data I will project the data to 2D.


```python
pca = PCA(n_components=2)

data['x']=pca.fit_transform(data[x_cols])[:,0]
data['y']=pca.fit_transform(data[x_cols])[:,1]

clusters_2d = data[['cluster3', 'x', 'y']]
```


```python
ggplot(clusters_2d, aes(x='x', y='y', color='cluster3')) + \
    scale_color_gradient(low='#E1FA72', high='#F46FEE') + \
    geom_point(size=75) + ggtitle("Customers Grouped by Cluster")
```


![png](/images/output_21_0.png)





    <ggplot: (-9223372036568001939)>



There is some overlap between the clusters. Let's look at the clusters more closely and see what people are buying for each cluster.

### Analyzing clusters


```python
# Making columns that indicate whether a customer is in a particular cluster
data['is_0'] = data.cluster3==0.0
data['is_1'] = data.cluster3==1.0
data['is_2'] = data.cluster3==2.0

just_wine = data.drop(['cluster3','x','y'],1)
```


```python
# Let's group by cluster
cluster0 = just_wine.groupby('is_0').sum()
cluster1 = just_wine.groupby('is_1').sum()
cluster2 = just_wine.groupby('is_2').sum()
```


```python
# Getting just the relevant row for each cluster
zero = cluster0.iloc[1:2]
one = cluster1.iloc[1:2]
two = cluster2.iloc[1:2]

# Let's put all the groups into one dataframe
all_clusters = zero.append(one, ignore_index=True)
all_clusters = all_clusters.append(two, ignore_index=True)

all_clusters
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Barbera</th>
      <th>Cabernet Franc</th>
      <th>Cabernet Sauvignon</th>
      <th>Champagne</th>
      <th>Chardonnay</th>
      <th>Espumante</th>
      <th>Gewurztraminer</th>
      <th>Malbec</th>
      <th>Merlot</th>
      <th>Montepulciano</th>
      <th>...</th>
      <th>Riesling</th>
      <th>Rose</th>
      <th>Sangiovese</th>
      <th>Sauvignon Blanc</th>
      <th>Semillon</th>
      <th>Syrah</th>
      <th>Zinfandel</th>
      <th>is_0</th>
      <th>is_1</th>
      <th>is_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>55</td>
      <td>81</td>
      <td>77</td>
      <td>17</td>
      <td>71</td>
      <td>7</td>
      <td>68</td>
      <td>35</td>
      <td>88</td>
      <td>57</td>
      <td>...</td>
      <td>67</td>
      <td>12</td>
      <td>45</td>
      <td>68</td>
      <td>54</td>
      <td>29</td>
      <td>52</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>140</td>
      <td>11</td>
      <td>1</td>
      <td>205</td>
      <td>9</td>
      <td>27</td>
      <td>10</td>
      <td>159</td>
      <td>11</td>
      <td>...</td>
      <td>28</td>
      <td>5</td>
      <td>11</td>
      <td>206</td>
      <td>28</td>
      <td>10</td>
      <td>212</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50</td>
      <td>34</td>
      <td>140</td>
      <td>2</td>
      <td>123</td>
      <td>4</td>
      <td>17</td>
      <td>7</td>
      <td>32</td>
      <td>48</td>
      <td>...</td>
      <td>17</td>
      <td>11</td>
      <td>49</td>
      <td>3</td>
      <td>11</td>
      <td>137</td>
      <td>141</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 25 columns</p>
</div>




```python
'''For some reason appending alphabetizes columns. 
The previous ordering was more convenient because reds were with reds
and whites were with whites, so I'll go back to that column ordering.
'''
all_clusters = all_clusters.reindex_axis(cluster0.columns, axis=1)
all_clusters
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cabernet Sauvignon</th>
      <th>Pinot Noir</th>
      <th>Zinfandel</th>
      <th>Syrah</th>
      <th>Cabernet Franc</th>
      <th>Malbec</th>
      <th>Barbera</th>
      <th>Sangiovese</th>
      <th>Montepulciano</th>
      <th>Merlot</th>
      <th>...</th>
      <th>Port</th>
      <th>Chardonnay</th>
      <th>Sauvignon Blanc</th>
      <th>Pinot Grigio</th>
      <th>Riesling</th>
      <th>Gewurztraminer</th>
      <th>Semillon</th>
      <th>Muscat</th>
      <th>is_1</th>
      <th>is_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>77</td>
      <td>69</td>
      <td>52</td>
      <td>29</td>
      <td>81</td>
      <td>35</td>
      <td>55</td>
      <td>45</td>
      <td>57</td>
      <td>88</td>
      <td>...</td>
      <td>10</td>
      <td>71</td>
      <td>68</td>
      <td>71</td>
      <td>67</td>
      <td>68</td>
      <td>54</td>
      <td>57</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>218</td>
      <td>212</td>
      <td>10</td>
      <td>140</td>
      <td>10</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>159</td>
      <td>...</td>
      <td>5</td>
      <td>205</td>
      <td>206</td>
      <td>27</td>
      <td>28</td>
      <td>27</td>
      <td>28</td>
      <td>26</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>140</td>
      <td>147</td>
      <td>141</td>
      <td>137</td>
      <td>34</td>
      <td>7</td>
      <td>50</td>
      <td>49</td>
      <td>48</td>
      <td>32</td>
      <td>...</td>
      <td>9</td>
      <td>123</td>
      <td>3</td>
      <td>18</td>
      <td>17</td>
      <td>17</td>
      <td>11</td>
      <td>14</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 24 columns</p>
</div>




```python
all_clusters.drop(['is_1','is_2'], axis=1, inplace=True)
all_clusters
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cabernet Sauvignon</th>
      <th>Pinot Noir</th>
      <th>Zinfandel</th>
      <th>Syrah</th>
      <th>Cabernet Franc</th>
      <th>Malbec</th>
      <th>Barbera</th>
      <th>Sangiovese</th>
      <th>Montepulciano</th>
      <th>Merlot</th>
      <th>...</th>
      <th>Espumante</th>
      <th>Champagne</th>
      <th>Port</th>
      <th>Chardonnay</th>
      <th>Sauvignon Blanc</th>
      <th>Pinot Grigio</th>
      <th>Riesling</th>
      <th>Gewurztraminer</th>
      <th>Semillon</th>
      <th>Muscat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>77</td>
      <td>69</td>
      <td>52</td>
      <td>29</td>
      <td>81</td>
      <td>35</td>
      <td>55</td>
      <td>45</td>
      <td>57</td>
      <td>88</td>
      <td>...</td>
      <td>7</td>
      <td>17</td>
      <td>10</td>
      <td>71</td>
      <td>68</td>
      <td>71</td>
      <td>67</td>
      <td>68</td>
      <td>54</td>
      <td>57</td>
    </tr>
    <tr>
      <th>1</th>
      <td>11</td>
      <td>218</td>
      <td>212</td>
      <td>10</td>
      <td>140</td>
      <td>10</td>
      <td>11</td>
      <td>11</td>
      <td>11</td>
      <td>159</td>
      <td>...</td>
      <td>9</td>
      <td>1</td>
      <td>5</td>
      <td>205</td>
      <td>206</td>
      <td>27</td>
      <td>28</td>
      <td>27</td>
      <td>28</td>
      <td>26</td>
    </tr>
    <tr>
      <th>2</th>
      <td>140</td>
      <td>147</td>
      <td>141</td>
      <td>137</td>
      <td>34</td>
      <td>7</td>
      <td>50</td>
      <td>49</td>
      <td>48</td>
      <td>32</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>9</td>
      <td>123</td>
      <td>3</td>
      <td>18</td>
      <td>17</td>
      <td>17</td>
      <td>11</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 22 columns</p>
</div>



Now if you wanted to, you can see which wines are most/least popular for each cluster, and more easily look at differences between the clusters.

### Most/least popular wines by cluster


```python
all_clusters.plot.bar().legend(loc='center left', bbox_to_anchor=(1, 0.5))
```




    <matplotlib.legend.Legend at 0x111caa7b8>




![png](/images/output_31_1.png)


Just some observations: Most of the Pinot Noir, Zinfandel, Merlot, Chardonnay, and Sauvignon Blanc sales come from cluster 1. And most of the Syrah sales are coming from those in cluster 2.

I'm also interested in the mean purchases for each wine type, grouped by cluster.


```python
cluster0_avg = just_wine.groupby('is_0').mean()
cluster1_avg = just_wine.groupby('is_1').mean()
cluster2_avg = just_wine.groupby('is_2').mean()
```


```python
# Here's the result of one of the group bys
cluster0_avg
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cabernet Sauvignon</th>
      <th>Pinot Noir</th>
      <th>Zinfandel</th>
      <th>Syrah</th>
      <th>Cabernet Franc</th>
      <th>Malbec</th>
      <th>Barbera</th>
      <th>Sangiovese</th>
      <th>Montepulciano</th>
      <th>Merlot</th>
      <th>...</th>
      <th>Port</th>
      <th>Chardonnay</th>
      <th>Sauvignon Blanc</th>
      <th>Pinot Grigio</th>
      <th>Riesling</th>
      <th>Gewurztraminer</th>
      <th>Semillon</th>
      <th>Muscat</th>
      <th>is_1</th>
      <th>is_2</th>
    </tr>
    <tr>
      <th>is_0</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>False</th>
      <td>1.135338</td>
      <td>2.744361</td>
      <td>2.654135</td>
      <td>1.105263</td>
      <td>1.308271</td>
      <td>0.127820</td>
      <td>0.458647</td>
      <td>0.451128</td>
      <td>0.443609</td>
      <td>1.436090</td>
      <td>...</td>
      <td>0.105263</td>
      <td>2.466165</td>
      <td>1.571429</td>
      <td>0.338346</td>
      <td>0.338346</td>
      <td>0.330827</td>
      <td>0.293233</td>
      <td>0.300752</td>
      <td>0.578947</td>
      <td>0.421053</td>
    </tr>
    <tr>
      <th>True</th>
      <td>0.496774</td>
      <td>0.445161</td>
      <td>0.335484</td>
      <td>0.187097</td>
      <td>0.522581</td>
      <td>0.225806</td>
      <td>0.354839</td>
      <td>0.290323</td>
      <td>0.367742</td>
      <td>0.567742</td>
      <td>...</td>
      <td>0.064516</td>
      <td>0.458065</td>
      <td>0.438710</td>
      <td>0.458065</td>
      <td>0.432258</td>
      <td>0.438710</td>
      <td>0.348387</td>
      <td>0.367742</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 24 columns</p>
</div>




```python
# Getting just the relevant row for each cluster
zero_avg = cluster0_avg.iloc[1:2]
one_avg = cluster1_avg.iloc[1:2]
two_avg = cluster2_avg.iloc[1:2]

# Let's put all the groups into one dataframe
all_clusters_avg = zero_avg.append(one_avg, ignore_index=True)
all_clusters_avg = all_clusters_avg.append(two_avg, ignore_index=True)

all_clusters_avg
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Barbera</th>
      <th>Cabernet Franc</th>
      <th>Cabernet Sauvignon</th>
      <th>Champagne</th>
      <th>Chardonnay</th>
      <th>Espumante</th>
      <th>Gewurztraminer</th>
      <th>Malbec</th>
      <th>Merlot</th>
      <th>Montepulciano</th>
      <th>...</th>
      <th>Riesling</th>
      <th>Rose</th>
      <th>Sangiovese</th>
      <th>Sauvignon Blanc</th>
      <th>Semillon</th>
      <th>Syrah</th>
      <th>Zinfandel</th>
      <th>is_0</th>
      <th>is_1</th>
      <th>is_2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.354839</td>
      <td>0.522581</td>
      <td>0.496774</td>
      <td>0.109677</td>
      <td>0.458065</td>
      <td>0.045161</td>
      <td>0.438710</td>
      <td>0.225806</td>
      <td>0.567742</td>
      <td>0.367742</td>
      <td>...</td>
      <td>0.432258</td>
      <td>0.077419</td>
      <td>0.290323</td>
      <td>0.438710</td>
      <td>0.348387</td>
      <td>0.187097</td>
      <td>0.335484</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.142857</td>
      <td>1.818182</td>
      <td>0.142857</td>
      <td>0.012987</td>
      <td>2.662338</td>
      <td>0.116883</td>
      <td>0.350649</td>
      <td>0.129870</td>
      <td>2.064935</td>
      <td>0.142857</td>
      <td>...</td>
      <td>0.363636</td>
      <td>0.064935</td>
      <td>0.142857</td>
      <td>2.675325</td>
      <td>0.363636</td>
      <td>0.129870</td>
      <td>2.753247</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.892857</td>
      <td>0.607143</td>
      <td>2.500000</td>
      <td>0.035714</td>
      <td>2.196429</td>
      <td>0.071429</td>
      <td>0.303571</td>
      <td>0.125000</td>
      <td>0.571429</td>
      <td>0.857143</td>
      <td>...</td>
      <td>0.303571</td>
      <td>0.196429</td>
      <td>0.875000</td>
      <td>0.053571</td>
      <td>0.196429</td>
      <td>2.446429</td>
      <td>2.517857</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 25 columns</p>
</div>




```python
all_clusters_avg = all_clusters_avg.reindex_axis(zero_avg.columns, axis=1)

all_clusters_avg.drop(['is_1','is_2'], axis=1, inplace=True)
all_clusters_avg
```




<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Cabernet Sauvignon</th>
      <th>Pinot Noir</th>
      <th>Zinfandel</th>
      <th>Syrah</th>
      <th>Cabernet Franc</th>
      <th>Malbec</th>
      <th>Barbera</th>
      <th>Sangiovese</th>
      <th>Montepulciano</th>
      <th>Merlot</th>
      <th>...</th>
      <th>Espumante</th>
      <th>Champagne</th>
      <th>Port</th>
      <th>Chardonnay</th>
      <th>Sauvignon Blanc</th>
      <th>Pinot Grigio</th>
      <th>Riesling</th>
      <th>Gewurztraminer</th>
      <th>Semillon</th>
      <th>Muscat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.496774</td>
      <td>0.445161</td>
      <td>0.335484</td>
      <td>0.187097</td>
      <td>0.522581</td>
      <td>0.225806</td>
      <td>0.354839</td>
      <td>0.290323</td>
      <td>0.367742</td>
      <td>0.567742</td>
      <td>...</td>
      <td>0.045161</td>
      <td>0.109677</td>
      <td>0.064516</td>
      <td>0.458065</td>
      <td>0.438710</td>
      <td>0.458065</td>
      <td>0.432258</td>
      <td>0.438710</td>
      <td>0.348387</td>
      <td>0.367742</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.142857</td>
      <td>2.831169</td>
      <td>2.753247</td>
      <td>0.129870</td>
      <td>1.818182</td>
      <td>0.129870</td>
      <td>0.142857</td>
      <td>0.142857</td>
      <td>0.142857</td>
      <td>2.064935</td>
      <td>...</td>
      <td>0.116883</td>
      <td>0.012987</td>
      <td>0.064935</td>
      <td>2.662338</td>
      <td>2.675325</td>
      <td>0.350649</td>
      <td>0.363636</td>
      <td>0.350649</td>
      <td>0.363636</td>
      <td>0.337662</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.500000</td>
      <td>2.625000</td>
      <td>2.517857</td>
      <td>2.446429</td>
      <td>0.607143</td>
      <td>0.125000</td>
      <td>0.892857</td>
      <td>0.875000</td>
      <td>0.857143</td>
      <td>0.571429</td>
      <td>...</td>
      <td>0.071429</td>
      <td>0.035714</td>
      <td>0.160714</td>
      <td>2.196429</td>
      <td>0.053571</td>
      <td>0.321429</td>
      <td>0.303571</td>
      <td>0.303571</td>
      <td>0.196429</td>
      <td>0.250000</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 22 columns</p>
</div>




```python
all_clusters_avg.plot.bar().legend(loc='center left', bbox_to_anchor=(1, 0.5))
```




    <matplotlib.legend.Legend at 0x1126172b0>




![png](/images/output_38_1.png)


Customers in cluster 0 buy less on average than the other two clusters, and don't seem to have strong preferences when it comes to reds vs whites. 

The customers in cluster 1 strongly prefer Pinot Noir, Zinfandel, Cabernet Franc, Merlot, Chardonnay, and Sauvignon Blanc over the other wines.

Customers in cluster 2 strongly prefer Cabernet Sauvignon, Pinot Noir, Zinfandel, Syrah, and Chardonnay, and buy more Italian wines on average. 

Unsurprisingly, dessert or sparkling or special occasion wines (such as Prosecco, Espumante, Champagne) are low for all clusters.


```python

```

